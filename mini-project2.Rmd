---
title: "Mini Project 2"
author: "Ankit Mathur, Nitesh Singh Jaswal"
date: "March 16, 2019"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(tidy = TRUE, warning = FALSE, echo = FALSE, message = FALSE)
library(foreign)
library(tidyverse)
library(broom)
library(data.table)
library(GGally)

```

```{r}
# Load Data
dfp_WTHH = read.csv("DFP_WTHH_release.csv")
names(dfp_WTHH)[1] <- "rowid"
dfp = dfp_WTHH %>% select(rowid, house3, presvote16post, weight_DFP, M4A, GREENJOB, WEALTH, MARLEG, ICE, GUNS, POP_1, POP_2, POP_3, gender)
# Removing NAs or 7 (Did not vote) for presvote16post
dfp =  dfp[!(is.na(dfp$presvote16post) | dfp$presvote16post == 7),]
# summary(dfp)
n_row = nrow(dfp)
```

# Solution 1:

```{r}
is_swing_voter <- function() {
  vect = as.numeric(rep.int(1, times = n_row))
  for(i in 1:n_row) {
    if(dfp$presvote16post[i] == 1 && dfp$house3[i] == 1)
      vect[i] = 2
    else if(dfp$presvote16post[i] == 2 && dfp$house3[i] == 2)
      vect[i] = 3
    else if(dfp$presvote16post[i] != 2 && dfp$house3[i] == 2)
      vect[i] = 4
    else if(dfp$presvote16post[i] != 1 && dfp$house3[i] == 1)
      vect[i] = 5
  }
  return(vect)
}
# 1 = Swing, 2 = Loyal Demo, 3 = Loyal Rep, 4 = Switch to R, 5 = Switch to D
dfp$is_swing = is_swing_voter()
dfp$is_swing = factor(dfp$is_swing, labels = c("Swing", "Loyal Democrat", "Loyal Republican", "Switch to R", "Switch to D"))

```

Let us first visualize the ggpairs plot to get the feel of the data:  
```{r message = FALSE, warning = FALSE}
dfp.q1 = dfp %>% subset(., subset = (.$is_swing == "Switch to R" | (.$is_swing == "Switch to D")), select = c("is_swing", "M4A", "GREENJOB", "WEALTH", "MARLEG", "ICE", "GUNS", "weight_DFP"))
ggpairs(dfp.q1, aes(color = is_swing), columns = c("is_swing", "M4A", "GREENJOB", "WEALTH", "MARLEG", "ICE", "GUNS"))
```

We can already get an idea of how the distribution of the response of the Switch to R/ Switch to D voters varies on the various issue variables. We further analyze the data, by plotting the histograms of the response of each issue variable for both the switch voters.

```{r message = FALSE, warning = FALSE}
cb_palette2 = c("#E69F00", "#56B4E9")

dfp.q1 = gather(dfp.q1, key = "ISSUE", value = "RESPONSE", c("M4A", "GREENJOB", "WEALTH", "MARLEG", "ICE", "GUNS"))
dfp.q1$RESPONSE = factor(dfp.q1$RESPONSE)
dfp.q1 = na.omit(dfp.q1)
ggplot(dfp.q1, aes(x = RESPONSE, color = is_swing, fill = is_swing)) + stat_count((aes(weight = weight_DFP))) + facet_wrap(~ISSUE) + theme_bw() + guides(fill = guide_legend(title="Swing Voters"), color = FALSE) + scale_fill_manual(values = cb_palette2) + labs(title="Distribution of response on Issue Variables for Switch to D/R voters", caption = "Response Values: 1. Strongly support  2. Somewhat support  3. Neither support nor oppose \n  4. Somewhat oppose  5. Strongly oppose  6. Not sure") + ylab("Count") + xlab("Response")
```

* From the above plot it can be observed that the Switch to D voters have a strong opinion on the issue variables GREENJOB, GUNS, M4A, MARLEG and WEALTH whereas the Switch to R voters have a strong opinion on ICE, MARLEG and M4A.
* The Switch to R and Switch to D voters differ strongly on issue variable M4A. The Switch to R voters show a peak on the response value 5(Strongly oppose) whereas the Switch to D voters peak on response value 1 (Strongly support).
* The Switch to R and Switch to D voters behave rather similarly on the issue of Marijuana Legalization (MARLEG) with both of their histograms peaking on response value 1 (Strongly support) and then decreasing from there on.
* It is interesting to note that the Switch to D voters show a much more homogenous response on many of the issue variables compared to Switch to R voters who demonstrate a more divided opinion. 